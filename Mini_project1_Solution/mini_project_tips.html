<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Tips_dataset</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="mini_project_tips_files/libs/clipboard/clipboard.min.js"></script>
<script src="mini_project_tips_files/libs/quarto-html/quarto.js"></script>
<script src="mini_project_tips_files/libs/quarto-html/popper.min.js"></script>
<script src="mini_project_tips_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="mini_project_tips_files/libs/quarto-html/anchor.min.js"></script>
<link href="mini_project_tips_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="mini_project_tips_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="mini_project_tips_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="mini_project_tips_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="mini_project_tips_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="mini_project_tips_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="mini_project_tips_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tips_dataset</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<blockquote class="blockquote">
<p>Imagine you are the waiter at a restaurant and want to estimate the tip based on the meal and some other characteristics. The goal of this project is to build linear models to predict <code>tips</code> based on characteristics of the meals. Use Root Mean Squared Error (RMSE) as the metric of error. We are looking for the model with lowest RMSE on the <code>tesing</code> data.</p>
</blockquote>
<section id="loading-some-important-libraries" class="level2">
<h2 class="anchored" data-anchor-id="loading-some-important-libraries">Loading some important libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importing-dataset" class="level2">
<h2 class="anchored" data-anchor-id="importing-dataset">Importing dataset</h2>
<p>We will use the dataset <code>tips</code> and for more information, read: <a href="https://rdrr.io/cran/reshape2/man/tips.html">tips documentation</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>tip <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">'https://raw.githubusercontent.com/mwaskom/seaborn-data/master/tips.csv'</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In order to work on the project, you should follow the following steps:</p>
<ol type="1">
<li>Study the distribution of each variable. Trying to understand them by computing some statistics: mean, variance, â€¦ and plot some graphics.</li>
</ol>
<p>To do this, we can use, for example, function <code>sumtable()</code> from <code>vtable</code> package. We will look at quantitative and qualitative data separately.</p>
<section id="quantitative-variables" class="level3">
<h3 class="anchored" data-anchor-id="quantitative-variables">Quantitative variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("vtable")</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vtable)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># numerical variables</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>tip <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(is.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sumtable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Summary Statistics</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">N</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Std. Dev.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Pctl. 25</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Pctl. 75</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">total_bill</td>
<td style="text-align: left;">244</td>
<td style="text-align: left;">20</td>
<td style="text-align: left;">8.9</td>
<td style="text-align: left;">3.1</td>
<td style="text-align: left;">13</td>
<td style="text-align: left;">24</td>
<td style="text-align: left;">51</td>
</tr>
<tr class="even">
<td style="text-align: left;">tip</td>
<td style="text-align: left;">244</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">1.4</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3.6</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">size</td>
<td style="text-align: left;">244</td>
<td style="text-align: left;">2.6</td>
<td style="text-align: left;">0.95</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">6</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The values above can be represented graphically as below. To understand a single numerical variable, density function, histogram, boxplot or violinplot are the suitable types of graphic.</p>
<div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function that plot density on top of histogram</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>plot_density <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">variable =</span> <span class="st">""</span>, </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">bandwidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"gray"</span>){</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  tip <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(is.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .data[[variable]])) <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">binwidth =</span> bandwidth,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> color) <span class="sc">+</span> </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Density of variable "</span>, variable)) <span class="ot">-&gt;</span> p</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">show</span>(p)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>tip <span class="sc">%&gt;%</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(is.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map2</span>(<span class="at">.y =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">plot_density</span>(.x, .y, <span class="at">color =</span> <span class="st">"#6178C3"</span>)) <span class="ot">-&gt;</span> temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-fig.ncol="3">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="mini_project_tips_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="mini_project_tips_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="mini_project_tips_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Most of the bills are around <span class="math inline">\(\$15\)</span> and can be up to more than <span class="math inline">\(\$50\)</span> for a very few cases. On the other hand, the tips are mostly around <span class="math inline">\(\$2\)</span> and only a few tips are higher than <span class="math inline">\(\$7.5\)</span>, while the highest bill is <span class="math inline">\(\$10\)</span>. Note that these high tips can be considered as outliers as majority of tips are less than <span class="math inline">\(\$5\)</span>. One might remove them when trying to build the model (before splitting the data into test and train).</p>
</blockquote>
</section>
<section id="qualitative-variables" class="level3">
<h3 class="anchored" data-anchor-id="qualitative-variables">Qualitative variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># categorical data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>tip <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>is.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sumtable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Summary Statistics</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">N</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sex</td>
<td style="text-align: left;">244</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">... Female</td>
<td style="text-align: left;">87</td>
<td style="text-align: left;">36%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">... Male</td>
<td style="text-align: left;">157</td>
<td style="text-align: left;">64%</td>
</tr>
<tr class="even">
<td style="text-align: left;">smoker</td>
<td style="text-align: left;">244</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">... No</td>
<td style="text-align: left;">151</td>
<td style="text-align: left;">62%</td>
</tr>
<tr class="even">
<td style="text-align: left;">... Yes</td>
<td style="text-align: left;">93</td>
<td style="text-align: left;">38%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">day</td>
<td style="text-align: left;">244</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">... Fri</td>
<td style="text-align: left;">19</td>
<td style="text-align: left;">8%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">... Sat</td>
<td style="text-align: left;">87</td>
<td style="text-align: left;">36%</td>
</tr>
<tr class="even">
<td style="text-align: left;">... Sun</td>
<td style="text-align: left;">76</td>
<td style="text-align: left;">31%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">... Thur</td>
<td style="text-align: left;">62</td>
<td style="text-align: left;">25%</td>
</tr>
<tr class="even">
<td style="text-align: left;">time</td>
<td style="text-align: left;">244</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">... Dinner</td>
<td style="text-align: left;">176</td>
<td style="text-align: left;">72%</td>
</tr>
<tr class="even">
<td style="text-align: left;">... Lunch</td>
<td style="text-align: left;">68</td>
<td style="text-align: left;">28%</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Distribution of each categorical variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tip <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>is.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"variable"</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> variable)) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mini_project_tips_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Most meals took place on Saturday and less than <span class="math inline">\(20\)</span> meals took places on Friday, while majority of the meals are dinner. Moreover, according to the observations, males often pay for the meal while majority of individuals are non-smoker.</p>
</blockquote>
<ol start="2" type="1">
<li>Study the relation of each predictors to the target <code>tips</code> (statistically and graphically). Base on your investigation up to this stage, can you guess what variables are important to predict the tips?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>tip <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           total_bill       tip      size
total_bill  1.0000000 0.6757341 0.5983151
tip         0.6757341 1.0000000 0.4892988
size        0.5983151 0.4892988 1.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tip <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> total_bill,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> tip)) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> size, <span class="at">color =</span> sex))   <span class="co"># lot of info</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mini_project_tips_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>tip <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> tip)) <span class="sc">+</span>   <span class="co"># quantitative vs quality</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> time))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mini_project_tips_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tip <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> tip)) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> day))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mini_project_tips_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><p>The correlation matrix shows that the total bill is highly correlated with the tip, while size of the meal also carries correlation close <span class="math inline">\(0.5\)</span> with tip as well. However, it is worth noticing that the two numerical inputs are also highly correlated which indicates that both of them might be redundant inputs in modeling tip.</p></li>
<li><p>The scatterplot conveys many information that the tips higher than <span class="math inline">\(\$7\)</span> are often accured for meal that are paid by males. For the lower tips, there is no different or relation between Gender and tips at all according to the scatterplot. The same thing can be observed between <code>tip</code> and <code>size</code>. Finally, the violinplots show that <code>type</code> and <code>day</code> of meals do not play significant role in characterizing tips either.</p></li>
</ul>
<ol start="3" type="1">
<li>Build linear models based on your choice of inputs using <code>lm</code> function. The model should be trained on the training data and predict the testing data as defined below.</li>
</ol>
<ul>
<li>Base on the previous investigation, we might try a few models:
<ul>
<li>a model with all inputs</li>
<li>a step subset search</li>
<li>a model with only total bill</li>
<li>a model with higher degree of total bill</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(tip)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">logical</span>(n)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">168</span>) <span class="co"># This will fix the train-test split. You will have the same train and test data</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>train[<span class="fu">sample</span>(n, <span class="fl">0.8</span><span class="sc">*</span>n)] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>tip_train <span class="ot">&lt;-</span> tip[train,]         <span class="co"># Train data</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>tip_test <span class="ot">&lt;-</span> tip[<span class="sc">!</span>train,]         <span class="co"># Test data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(tip <span class="sc">~</span> ., </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> tip_train)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>step_model <span class="ot">&lt;-</span> <span class="fu">step</span>(full_model, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=42.08
tip ~ total_bill + sex + smoker + day + time + size

             Df Sum of Sq    RSS     AIC
- day         3     0.482 221.11  36.507
- time        1     0.001 220.63  40.083
- smoker      1     0.014 220.65  40.094
- sex         1     0.445 221.08  40.475
&lt;none&gt;                    220.63  42.082
- size        1     2.426 223.06  42.214
- total_bill  1    81.378 302.01 101.305

Step:  AIC=36.51
tip ~ total_bill + sex + smoker + time + size

             Df Sum of Sq    RSS    AIC
- smoker      1     0.003 221.12 34.510
- time        1     0.236 221.35 34.715
- sex         1     0.330 221.44 34.798
&lt;none&gt;                    221.11 36.507
- size        1     2.666 223.78 36.844
+ day         3     0.482 220.63 42.082
- total_bill  1    81.107 302.22 95.441

Step:  AIC=34.51
tip ~ total_bill + sex + time + size

             Df Sum of Sq    RSS    AIC
- time        1     0.234 221.35 32.717
- sex         1     0.330 221.45 32.800
&lt;none&gt;                    221.12 34.510
- size        1     2.843 223.96 35.001
+ smoker      1     0.003 221.11 36.507
+ day         3     0.471 220.65 40.094
- total_bill  1    84.110 305.23 95.371

Step:  AIC=32.72
tip ~ total_bill + sex + size

             Df Sum of Sq    RSS    AIC
- sex         1     0.246 221.60 30.933
&lt;none&gt;                    221.35 32.717
- size        1     2.856 224.21 33.216
+ time        1     0.234 221.12 34.510
+ smoker      1     0.002 221.35 34.715
+ day         3     0.704 220.65 38.095
- total_bill  1    88.151 309.50 96.083

Step:  AIC=30.93
tip ~ total_bill + size

             Df Sum of Sq    RSS    AIC
&lt;none&gt;                    221.60 30.933
- size        1     2.927 224.52 31.492
+ sex         1     0.246 221.35 32.717
+ time        1     0.151 221.45 32.800
+ smoker      1     0.001 221.60 32.932
+ day         3     0.501 221.10 36.492
- total_bill  1    88.579 310.18 94.508</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>total_bill_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(tip <span class="sc">~</span> total_bill, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> tip_train)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>higher_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(tip <span class="sc">~</span> total_bill <span class="sc">+</span> size <span class="sc">+</span> <span class="fu">I</span>(total_bill <span class="sc">^</span><span class="dv">2</span>), </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> tip_train)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>all_models <span class="ot">&lt;-</span> <span class="fu">list</span>(full_model,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                  step_model,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                  total_bill_model,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                  higher_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We shall look at the summary of all the models to have a glimpse of how they perform on the training data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>all_models <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="at">.f =</span> summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]

Call:
lm(formula = tip ~ ., data = tip_train)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.9110 -0.6142 -0.1210  0.4874  4.0965 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.00447    0.45193   2.223   0.0274 *  
total_bill   0.09289    0.01121   8.283 2.32e-14 ***
sexMale     -0.10376    0.16943  -0.612   0.5410    
smokerYes   -0.01856    0.17390  -0.107   0.9151    
daySat      -0.15549    0.39863  -0.390   0.6969    
daySun      -0.06257    0.40709  -0.154   0.8780    
dayThur     -0.18190    0.52944  -0.344   0.7316    
timeLunch   -0.01677    0.57582  -0.029   0.9768    
size         0.15244    0.10660   1.430   0.1544    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.089 on 186 degrees of freedom
Multiple R-squared:  0.444, Adjusted R-squared:  0.4201 
F-statistic: 18.56 on 8 and 186 DF,  p-value: &lt; 2.2e-16


[[2]]

Call:
lm(formula = tip ~ total_bill + size, data = tip_train)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.9760 -0.6143 -0.0993  0.5393  4.0355 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.79732    0.22824   3.493 0.000592 ***
total_bill   0.09217    0.01052   8.761 1.01e-15 ***
size         0.16140    0.10135   1.593 0.112911    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.074 on 192 degrees of freedom
Multiple R-squared:  0.4415,    Adjusted R-squared:  0.4357 
F-statistic:  75.9 on 2 and 192 DF,  p-value: &lt; 2.2e-16


[[3]]

Call:
lm(formula = tip ~ total_bill, data = tip_train)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.2003 -0.6074 -0.0990  0.5460  3.7902 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1.011498   0.185143   5.463 1.43e-07 ***
total_bill  0.102309   0.008407  12.169  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.079 on 193 degrees of freedom
Multiple R-squared:  0.4342,    Adjusted R-squared:  0.4312 
F-statistic: 148.1 on 1 and 193 DF,  p-value: &lt; 2.2e-16


[[4]]

Call:
lm(formula = tip ~ total_bill + size + I(total_bill^2), data = tip_train)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.9649 -0.6226 -0.0885  0.5421  3.9713 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)     0.8601978  0.4084715   2.106   0.0365 *
total_bill      0.0855620  0.0370788   2.308   0.0221 *
size            0.1643829  0.1028646   1.598   0.1117  
I(total_bill^2) 0.0001270  0.0006837   0.186   0.8528  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.077 on 191 degrees of freedom
Multiple R-squared:  0.4416,    Adjusted R-squared:  0.4329 
F-statistic: 50.36 on 3 and 191 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>By looking at R-squared, one can feel how does the model perform on the training data. Also, we can look at which variable are significant in those cases. Remember that this is just the performance of the model on the data it was built. Now letâ€™s look at the performance of the models on the testing data.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>name <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"MSE of full model: "</span>,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">"MSE of stepwise model: "</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">"MSE of model with only total bill: "</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>          <span class="st">"MSE of model of higher degree model: "</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">map2</span>(name,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>     all_models,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">.f =</span> <span class="cf">function</span>(x, y){</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">return</span>(<span class="fu">paste0</span>(x, <span class="fu">mean</span>((tip_test<span class="sc">$</span>tip <span class="sc">-</span> <span class="fu">predict</span>(y, tip_test))<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>     })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "MSE of full model: 0.556772473784954"

[[2]]
[1] "MSE of stepwise model: 0.54202970535065"

[[3]]
[1] "MSE of model with only total bill: 0.586724119095905"

[[4]]
[1] "MSE of model of higher degree model: 0.542366036270941"</code></pre>
</div>
</div>
<ul>
<li><p>The result suggested that the stepwise model with only two inputs: <code>size</code> and <code>total_bill</code> are the best one among all the constructed models.</p></li>
<li><p>Later, we will learn how to control the coefficients of the model to a limited range and that can play an important rule in improving model performance.</p></li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>